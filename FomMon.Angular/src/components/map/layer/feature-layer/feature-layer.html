<app-map-layer-group
      [groupId]="groupId()"
      category="feature"
      [name]="layer().name"
      [order]="5"
      [thumbnailImg]="'assets/layer-preview-osm-base.png'"
      [initiallyVisible]="true"
  >
  <mgl-vector-source
          [id]="layer().source"
          [tiles]="[url()]"
          [attribution]="layer().attribution"
          [promoteId]="layer().sourceIdColumn"
  >
    <!-- Polygon Fill layer -->
    @if (layer().geometryType === 'POLYGON') {
      <app-layer
              [id]="layer().tileSource"
              [groupId]="groupId()"
              type="fill"
              [interactivity]="{select: true, hover: true}"
              (beforeSelect)="onBeforeSelect($event)"
              [source]="layer().source"
              [sourceLayer]="layer().tileSource"
              [paint]="{
              'fill-color': [
                'case',
                'selected' | isState, '#FFB347',
                'alert' | isState, '#f54a00',
                layer().color
              ],
              'fill-opacity': [
                'case',
                'hide' | isState, 0,
                'selected' | isState, 0.7,
                'hover' | isState, 0.5,
                0.2
              ]
            }"
      />

      <!-- Polygon outline layer -->
      <app-layer
          [groupId]="groupId()"
          [id]="layer().tileSource + '-outline'"
          type="line"
          [source]="layer().source"
          [sourceLayer]="layer().tileSource"
          [paint]="{
            'line-color': [
              'case',
              'selected' | isState, '#F58F00',
              'alert' | isState, '#f54a00',
              layer().color
            ],
            'line-width': [
              'case',
              'selected' | isState, 3,
              'hover' | isState, 2,
              1
            ],
            'line-opacity': [
              'case',
              'hide' | isState, 0,
              0.3
            ]
          }"
          [minzoom]="6"


      />
    } @else if (layer().geometryType === 'LINESTRING') {

      <!-- Line layer -->
      <app-layer
        [groupId]="groupId()"
        [id]="layer().tileSource + '-line'"
        type="line"
        [interactivity]="{select: true, hover: true}"
        (beforeSelect)="onBeforeSelect($event)"
        [source]="layer().source"
        [sourceLayer]="layer().tileSource"
        [minzoom]="8"
        [paint]="{
      'line-color': [
          'case',
          'selected' | isState, '#F58F00',
          'alert' | isState, '#f54a00',
          layer().color
        ],
      'line-width': [
        'case',
        'selected' | isState, 3,
        'hover' | isState, 2,
        2
      ],
      'line-dasharray': [2, 0.5],
      'line-opacity': [
        'case',
        'hide' | isState, 0,
        'selected' | isState, 1,
        'hover' | isState, 0.8,
        0.5
      ]

    }"


      ></app-layer>
    }
  </mgl-vector-source>

</app-map-layer-group>